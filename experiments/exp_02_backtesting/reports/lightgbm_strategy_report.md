# LightGBM 기반 트레이딩 전략 백테스팅 보고서

**작성일**: 2023-04-03
**실험명**: exp_02_backtesting
**작성자**: AI Assistant

## 개요

이 보고서는 LightGBM 머신러닝 알고리즘을 활용한 트레이딩 전략을 구현하고, 기존의 전통적인 기술적 지표 기반 전략들과 성능을 비교한 결과를 담고 있습니다. 백테스트는 2018년부터 2022년까지의 시장 데이터를 사용하여 수행되었습니다.

## LightGBM 전략 구현

### 주요 특징

LightGBM 전략은 과거 가격 데이터로부터 추출한 다양한 특성(feature)들을 학습하여 미래 가격 움직임을 예측하는 머신러닝 기반 접근 방식입니다.

1. **데이터 특성 생성**:
   - 기본 가격 움직임 (수익률, 모멘텀)
   - 다양한 기간의 이동평균선
   - 볼린저 밴드
   - RSI (상대강도지수)
   - MACD (이동평균수렴확산)
   - 거래량 지표
   - 가격 변동성 지표

2. **모델 학습 방식**:
   - 학습 목표: N일 후(기본값 5일) 가격 변화율 예측
   - 정기적 재학습: 일정 기간(기본값 60일)마다 모델 재학습
   - 온라인 학습: 데이터가 누적됨에 따라 점진적으로 학습 데이터 확장

3. **매매 신호 생성**:
   - 상승 예측 임계값(threshold_buy) 이상: 매수 신호
   - 하락 예측 임계값(threshold_sell) 이하: 매도 신호
   - 그 외: 홀드(무행동)

## 백테스트 설정

- **테스트 기간**: 2018-01-01부터 2022-12-31까지
- **초기 자본금**: 10,000 단위
- **거래 수수료**: 0.1% (매수/매도 시 적용)
- **사용된 LightGBM 파라미터**:
  - prediction_horizon: 5 (5일 후 수익률 예측)
  - train_interval: 60 (60일마다 모델 재학습)
  - features_lookback: 20 (특성 계산을 위한 룩백 기간)
  - threshold_buy: 0.01 (1% 이상 상승 예상 시 매수)
  - threshold_sell: -0.01 (1% 이상 하락 예상 시 매도)

## 성능 결과

### LightGBM 전략 성과

- **총 수익률**: 53.93%
- **연간화된 수익률**: 9.01%
- **샤프 비율**: 0.61
- **최대 손실(Drawdown)**: -22.24%
- **승률**: 70.37%
- **총 거래 횟수**: 27회

### 기존 전략과의 비교

| 전략 | 총 수익률 (%) | 연간 수익률 (%) | 샤프 비율 | 최대 손실 (%) | 승률 (%) |
|------|--------------|---------------|----------|-------------|---------|
| MACD | 100.52 | 14.94 | 0.93 | -28.60 | 48.98 |
| Composite | 91.22 | 13.85 | 0.76 | -37.46 | 45.45 |
| MovingAverage | 85.49 | 13.16 | 0.74 | -27.31 | 46.15 |
| RSI | 68.93 | 11.06 | 0.71 | -21.86 | 76.92 |
| LightGBM | 53.93 | 9.01 | 0.61 | -22.24 | 70.37 |

## 분석 결과

백테스트 결과를 분석한 결과, 다음과 같은 주요 관찰 사항이 확인되었습니다:

1. **수익률 측면**:
   - LightGBM 전략은 53.93%의 총 수익률로 비교 대상 중 가장 낮은 성과를 보였습니다.
   - MACD 전략이 100.52%로 가장 높은 수익률을 기록했습니다.

2. **위험 지표**:
   - LightGBM 전략의 최대 손실(Drawdown)은 -22.24%로, RSI(-21.86%) 다음으로 낮은 수준이었습니다.
   - 이는 LightGBM이 수익률은 낮지만 위험 관리 측면에서는 상대적으로 강점을 보였음을 의미합니다.

3. **거래 효율성**:
   - LightGBM은 70.37%의 높은 승률을 보였으며, 이는 RSI(76.92%) 다음으로 높은 수치입니다.
   - 총 거래 횟수는 27회로 MACD(49회)보다 적었지만 MovingAverage, RSI, Composite 전략보다는 많았습니다.

4. **리스크 대비 수익률**:
   - 샤프 비율 기준으로는 MACD(0.93)가 가장 높았고, LightGBM(0.61)이 가장 낮았습니다.
   - 이는 위험 대비 수익률 효율성 측면에서 개선의 여지가 있음을 시사합니다.

## 특성 중요도 분석

LightGBM 모델에서 예측에 가장 큰 영향을 미친 상위 10개 특성:

1. momentum_5 (5일 모멘텀)
2. momentum_10 (10일 모멘텀)
3. rsi_14 (14일 RSI)
4. close_ma_20_diff (현재 가격과 20일 이동평균의 차이)
5. macd_histogram
6. returns_5d (5일 수익률)
7. bb_position_20 (20일 볼린저 밴드 내 위치)
8. volume_ratio
9. close_ma_50_diff
10. daily_range (일일 변동폭)

## 향후 개선 방안

1. **파라미터 최적화**:
   - 그리드 서치나 베이지안 최적화를 통한 LightGBM 하이퍼파라미터 튜닝
   - threshold_buy/sell 임계값 조정

2. **특성 엔지니어링**:
   - 추가 특성 개발 (계절성, 이벤트 기반 특성 등)
   - 특성 선택 알고리즘을 통한 최적 특성 집합 선택

3. **모델 앙상블**:
   - LightGBM과 기존 기술적 지표들을 결합한 하이브리드 전략 개발
   - 다양한 시간대의 예측 모델 앙상블

4. **시장 상황별 전략 분화**:
   - 시장 상황(상승장/하락장/횡보장)에 따른 적응형 전략 개발
   - 변동성에 따른 포지션 사이징 조정

## 결론

LightGBM 기반 트레이딩 전략은 비교 대상 중 수익률 측면에서는 가장 낮은 성과를 보였지만, 높은 승률과 상대적으로 낮은 최대 손실을 보여 위험 관리 측면에서는 장점을 가지고 있습니다. 

기존 기술적 지표 기반 전략들이 단순한 규칙으로도 높은 수익률을 보인 반면, 머신러닝 기반 전략은 아직 최적화의 여지가 많이 남아있습니다. 향후 파라미터 튜닝, 특성 엔지니어링, 앙상블 전략 등을 통해 LightGBM 전략의 성능을 개선할 수 있을 것으로 기대됩니다.

## 부록: 백테스트 차트

성능 차트는 `experiments/exp_02_backtesting/results/charts/` 디렉토리에서 확인할 수 있습니다:

- LightGBM_performance.png: LightGBM 전략의 포트폴리오 성과
- LightGBM_returns.png: LightGBM 전략의 누적 수익률
- lightgbm_comparison.png: 전략 간 비교 차트 